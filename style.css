/* ==========================================================================
   ALEGREMENTE 2025 · GUIA DE ESCENA
   style.css — Versión extendida y accesible
   - Sistema de variables y temas por escena
   - Layout responsive con grid
   - Filtros/chips con persistencia visual
   - Cards plegables
   - Reproductor mejorado
   - Visor PDF, assets e imágenes con overlay
   - Estados de enfoque (accesibilidad) y modo impresión
   - Soporta prefers-reduced-motion y esquema de color
   ========================================================================== */

/* ==============================
   Reset básico + tipografía
============================== */
*,
*::before,
*::after { box-sizing: border-box; }
html, body { height: 100%; }
html { -webkit-text-size-adjust: 100%; }
body{
  margin: 0;
  font-family: system-ui, "Segoe UI", Roboto, Helvetica, Arial, "Noto Sans", sans-serif;
  line-height: 1.6;
  color: var(--text);
  background: var(--bg);
  text-rendering: optimizeLegibility;
}

/* ==============================
   Paleta base (por defecto)
   — Luego se sobreescribe por escena
============================== */
:root{
  --brand:        #7c3aed; /* violeta vivo */
  --brand-2:      #06b6d4; /* cian suave para acentos */
  --brand-dark:   #5b21b6;
  --ok:           #f59e0b;
  --ok-dark:      #b45309;
  --bg:           #f8fafc; /* gris muy claro */
  --paper:        #ffffff;
  --text:         #1f2937; /* gris-900 */
  --muted:        #6b7280; /* gris-500 */
  --border:       #e5e7eb; /* gris-200 */
  --soft:         #f1f5f9; /* gris-100 */
  --shadow-1:     0 2px 6px rgba(0,0,0,.06);
  --shadow-2:     0 10px 25px rgba(0,0,0,.08);
  --focus:        0 0 0 3px color-mix(in srgb, var(--brand) 30%, transparent);
  --radius-sm:    6px;
  --radius:       10px;
  --radius-lg:    14px;
  --container:    1200px;

  /* Tipos */
  --h1: 22px;
  --h2: 18px;
  --small: 13px;

  /* Contenido embebido */
  --pdf-h: 520px;
}

/* =========================================
   Tema específico: ESCENA 6 (Tierra Imaginaria)
   — Paleta fantástica + decoraciones sutiles
========================================= */
body#scene6{
  --brand:     #a855f7;     /* violeta-lila */
  --brand-2:   #22d3ee;     /* cian brillante */
  --brand-dark:#7c3aed;
  --bg:        #f8f7ff;     /* lila pálido */
  --soft:      #f5f3ff;     /* lavanda muy suave */
  --focus:     0 0 0 3px rgba(168,85,247,.25);
}

/* Soporte dark mode opcional del SO */
@media (prefers-color-scheme: dark){
  :root{
    --bg:     #0b1020;
    --paper:  #0f172a;
    --text:   #e5e7eb;
    --muted:  #94a3b8;
    --border: #1f2a44;
    --soft:   #0b1530;
    --shadow-1: 0 2px 8px rgba(0,0,0,.45);
    --shadow-2: 0 20px 40px rgba(0,0,0,.35);
    --focus: 0 0 0 3px color-mix(in srgb, var(--brand) 50%, transparent);
  }
}

/* ==============================
   Contenedor
============================== */
.wrap{ max-width: var(--container); margin: 0 auto; padding: 0 16px; }

/* ==============================
   Barra superior
============================== */
.top{
  background: var(--paper);
  border-bottom: 1px solid var(--border);
  margin-bottom: 14px;
  position: sticky;
  top: 0;
  z-index: 50;
  backdrop-filter: saturate(140%) blur(6px);
}
.topbar{
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 6px;
}
.topbar .brand{ display:flex; align-items:center; gap:10px; }
.topbar h1{
  margin:0; font-size: var(--h1); line-height:1.2;
  color: var(--brand);
  letter-spacing: .2px;
}
.topbar small{ font-size: var(--small); color: var(--muted); display:block; }
.topbar img{
  width:36px; height:36px; border-radius: 10px; object-fit:cover; box-shadow: var(--shadow-1);
}

.btn-back{
  background: linear-gradient(135deg, var(--brand) 0%, var(--brand-2) 100%);
  color:#fff; padding:9px 14px; border-radius: var(--radius);
  text-decoration:none; transition: transform .12s ease, filter .2s ease;
  display:inline-flex; align-items:center; gap:6px; font-weight:600;
  box-shadow: var(--shadow-1);
}
.btn-back:hover{ filter: brightness(1.05); transform: translateY(-1px); }
.btn-back:active{ transform: translateY(0); }

/* ==============================
   Reproductor
============================== */
.playerbar{
  background: var(--soft);
  border-bottom:1px solid var(--border);
  padding:8px 0;
}
.player{
  display:flex; align-items:center; gap:10px;
}
.player label{ font-weight:700; font-size:14px; }
.player audio{ flex:1; min-width: 180px; accent-color: var(--brand); }
.player .btn{
  background: var(--ok); color:#fff; padding:8px 12px; border-radius: var(--radius-sm);
  border:none; cursor:pointer; transition: transform .12s ease, background .2s ease;
  box-shadow: var(--shadow-1); font-weight:600;
}
.player .btn:hover{ background: var(--ok-dark); transform: translateY(-1px); }
.player .btn:active{ transform: translateY(0); }

/* ==============================
   Filtros y búsqueda
============================== */
.filters{
  background: var(--paper);
  border-bottom:1px solid var(--border);
  padding:10px 0 6px;
}
.filter-group{ padding:6px 0; }
.filter-group h4{ margin:0 0 6px; font-size:13px; color:#475569; font-weight:700; }
.chip{
  display:inline-flex; align-items:center; gap:6px;
  background:#eef2ff;
  color:#333;
  padding:5px 11px; margin:4px 6px 0 0; border-radius: 30px;
  font-size:13px; cursor:pointer; transition: all .15s ease;
  border:1px solid #e5e7eb; user-select:none;
}
.chip:hover{ background:#e0e7ff; transform: translateY(-1px); }
.chip.active{
  background: linear-gradient(135deg, var(--brand) 0%, var(--brand-2) 100%);
  color:#fff; border-color: transparent; transform: scale(1.03);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--brand) 18%, transparent);
}

.toolbar{ padding:8px 0 2px; }
.search input{
  width:100%; padding:10px 12px; border:1px solid #cbd5e1; border-radius: 10px; outline:none;
  font-size:14px; background:#fff;
  transition: box-shadow .2s ease, border-color .2s ease;
}
.search input:focus{
  border-color: var(--brand);
  box-shadow: var(--focus);
}

/* ==============================
   Layout principal
============================== */
main.wrap{ margin: 18px auto 24px; }
.grid{ display:grid; grid-template-columns: 2fr 1fr; gap: 20px; }
@media (max-width: 980px){ .grid{ grid-template-columns:1fr; } }

/* ==============================
   Imagen hero (con decoración sutil)
============================== */
.hero{
  position: relative; margin-bottom: 18px; border-radius: var(--radius-lg);
  overflow: hidden; box-shadow: var(--shadow-2);
  background:
    radial-gradient(1200px 280px at 20% -40%, color-mix(in srgb, var(--brand) 8%, transparent), transparent 60%),
    radial-gradient(1000px 240px at 110% -60%, color-mix(in srgb, var(--brand-2) 10%, transparent), transparent 65%);
}
.hero img{
  width:100%; display:block;
  aspect-ratio: 16/9; object-fit: cover;
}

/* Esferas flotantes para la ESCENA 6 */
body#scene6 .hero::after{
  content:"";
  position:absolute; inset:auto 10% -14% auto;
  width: 220px; height: 220px; border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #ffffff, #f0e9ff 40%, #e9d5ff 70%, transparent 72%);
  filter: blur(2px); opacity:.75;
  animation: orb 9s ease-in-out infinite alternate;
}
@keyframes orb{
  from{ transform: translateY(0) translateX(0) rotate(0deg); }
  to  { transform: translateY(-18px) translateX(12px) rotate(6deg); }
}
@media (prefers-reduced-motion: reduce){
  .hero::after{ animation: none; }
}

/* ==============================
   Componente: Card
============================== */
.card{
  background: var(--paper);
  border:1px solid var(--border);
  border-radius: var(--radius-lg);
  margin-bottom: 20px;
  overflow: hidden;
  box-shadow: var(--shadow-1);
}
.card header{
  background:
    linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0) 100%),
    color-mix(in srgb, var(--brand) 8%, #eef2ff);
  padding: 12px 14px;
  font-weight: 800;
  cursor: pointer;
  display:flex; justify-content:space-between; align-items:center; user-select:none;
}
.card header:hover{
  background: color-mix(in srgb, var(--brand) 12%, #e9efff);
}
.card header:focus-visible{ outline: none; box-shadow: var(--focus) inset; }
.card .caret{ font-size:12px; color: var(--muted); }
.card .content{ padding: 14px; display:block; animation: fadeIn .25s ease; }
.card p{ margin: 6px 0; }
.card ul, .card ol{ padding-left: 20px; margin: 8px 0 0; }
.card li{ margin-bottom: 6px; }
.card code{
  background: #f3f4f6; border:1px solid #e5e7eb; padding:2px 6px; border-radius:6px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: 12px;
}
.card table{
  width:100%; border-collapse: collapse; margin-top: 10px;
}
.card th, .card td{
  border:1px solid var(--border); padding:8px 10px; text-align:left; font-size:14px;
}
.card th{ background: #f8fafc; }

/* Etiquetas tipo pill */
.pill{
  display:inline-block; background: linear-gradient(135deg, var(--brand) 0%, var(--brand-2) 100%);
  color:#fff; font-size:11px; padding: 4px 10px; margin: 2px 4px 0 0; border-radius: 999px;
  letter-spacing: .2px;
}

/* Notas */
.note{
  background: #fff7e6; border-left: 4px solid #ffb703;
  padding: 8px 10px; margin-top: 10px; font-size: 13px; border-radius: 6px 10px 10px 6px;
}
.muted{ color: var(--muted); font-size: 13px; }

/* ==============================
   Botones & Acciones
============================== */
.btn{
  background: linear-gradient(135deg, var(--brand) 0%, var(--brand-2) 100%);
  color:#fff; padding:8px 12px; border-radius: 10px; text-decoration:none;
  font-size:14px; display:inline-flex; align-items:center; gap:8px;
  margin:4px 0; transition: transform .12s ease, filter .2s ease; border: none;
  cursor: pointer; box-shadow: var(--shadow-1); font-weight: 700;
}
.btn:hover{ filter: brightness(1.05); transform: translateY(-1px); }
.btn:active{ transform: translateY(0); }
.actions{ margin-top:10px; display:flex; gap:10px; flex-wrap:wrap; }

/* Enlaces deshabilitados */
a[aria-disabled="true"]{
  opacity:.6; cursor:not-allowed; pointer-events:none;
}

/* ==============================
   Assets (imágenes y fondos)
============================== */
.stage-assets{ display:flex; flex-wrap:wrap; gap: 14px; }
.asset{ flex: 1 1 160px; text-align:center; }
.asset img{
  width:100%; border:1px solid var(--border); border-radius: 10px; display:block; background:#fff;
  box-shadow: var(--shadow-1);
}
.asset small{ color: var(--muted); display:block; margin-top: 4px; }

/* Grilla auxiliar de assets */
.asset-grid{
  display:grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 12px;
}

/* ==============================
   Visor PDF
============================== */
.pdf-frame{
  width:100%; height: var(--pdf-h);
  border:1px solid var(--border); border-radius: 10px; margin-top: 10px;
  background: #0b1020;
}

/* ==============================
   Checklist genérica (IDs libres por escena)
============================== */
ul[id^="check-"] li{
  margin-bottom: 6px; font-size: 14px;
}
ul[id^="check-"] li input[type="checkbox"]{
  margin-right: 8px; transform: translateY(1px);
  accent-color: var(--brand);
}

/* ==============================
   Aside
============================== */
aside .card{ font-size:14px; }
aside ul{ list-style:none; padding-left:0; margin: 8px 0 0; }
aside li{ margin-bottom:6px; }

/* ==============================
   Footer
============================== */
.footer{
  text-align:center; font-size: 13px; color: #8a94a7;
  margin-top: 26px; padding: 16px 8px;
}

/* ==============================
   Imagen: Overlay (preview)
============================== */
#imgPreviewOverlay{
  position: fixed; inset: 0; display: none; z-index: 9999;
  background: rgba(4,6,18,.86);
  align-items: center; justify-content: center;
  padding: 24px;
}
#imgPreviewOverlay img{
  max-width: 92vw; max-height: 92vh; border-radius: 14px;
  box-shadow: 0 20px 60px rgba(0,0,0,.45);
}

/* ==============================
   Utilidades
============================== */
.center{ text-align:center; }
.hidden{ display:none !important; }
.kbd{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  background:#f3f4f6; padding: 2px 6px; border-radius: 6px; border:1px solid #e5e7eb; font-size: 12px;
}

/* ==============================
   Estados de enfoque accesibles
============================== */
a, button, .chip, .btn, .card > header{
  outline: none;
}
a:focus-visible, button:focus-visible, .chip:focus-visible, .btn:focus-visible, .card > header:focus-visible{
  box-shadow: var(--focus);
  border-radius: 10px;
}

/* ==============================
   Modo impresión
============================== */
@media print{
  :root{ --bg:#fff; }
  body{ background:#fff; color:#000; }
  .filters, .playerbar, .toolbar, .btn, .btn-back{ display:none !important; }
  .top{ border:none; margin: 0 0 10px 0; background:#fff; }
  .card{ break-inside: avoid; page-break-inside: avoid; box-shadow: none; border-color: #bbb; }
  .pdf-frame{ height: 380px; }
  a{ color:#000; text-decoration:none; }
}

/* ==============================
   Animaciones
============================== */
@keyframes fadeIn{
  from{ opacity:0; transform: translateY(5px); }
  to  { opacity:1; transform: translateY(0); }
}

/* ==============================
   Extras específicos de ESCENA 6
   - Borde y sombra “onírico” para headers de tarjetas
============================== */
body#scene6 .card header{
  border-bottom: 1px dashed color-mix(in srgb, var(--brand) 22%, transparent);
  background:
    radial-gradient(240px 100px at 0% 0%, color-mix(in srgb, var(--brand) 10%, transparent), transparent 70%),
    radial-gradient(200px 80px at 100% 0%, color-mix(in srgb, var(--brand-2) 12%, transparent), transparent 70%),
    color-mix(in srgb, var(--brand) 7%, #eef2ff);
}

/* Listas decoradas (indicaciones musicales o creativas) */
body#scene6 .card ul li::marker{
  color: color-mix(in srgb, var(--brand) 65%, var(--brand-2));
}
